# Create beta releases on pushes to develop

name: Beta Release

on:
  push:
    branches:
      - develop

jobs:
  build-for-beta-release:
    uses: ./.github/workflows/_release.yml

  build-wheels-for-beta-release:
    uses: ./.github/workflows/_python-wheels.yml

  upload-wheels-for-beta-release:
    needs: [build-wheels-for-beta-release]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/download-artifact@v2
        with:
          name: artifact
          path: dist

      - name: Publish package to Test PyPI
        uses: pypa/gh-action-pypi-publish@v1.4.2
        with:
          user: __token__
          password: ${{ secrets.test_pypi_token }}
          repository_url: https://test.pypi.org/legacy/
